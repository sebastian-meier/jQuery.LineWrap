(function(a){a.fn.linewrap=function(b){var c={padding:Array(3,10,3,10),margin:Array(0,0,0,0),background:"#ff0000",mode:"word",align:"left",extrapadding:0};var b=a.extend(c,b);return this.each(function(){obj=a(this);var p='<span class="jq-linewrap-line">';var m="</span>";var d=obj.parent().width();obj.parent().width(d-b.padding[1]-b.padding[3]-2*b.extrapadding);var q=obj.html();obj.html(q.substr(0,2));var h=obj.height();var r=new Array();var n=0;switch(b.mode){case"word":var k=q.split(" ");var o;for(var f=1;f<k.length+1;f++){o=new Array();for(var e=n;e<f;e++){o.push(k[e])}obj.html(o.join(" "));if(h!=obj.height()){o=new Array();for(var e=n;e<f-1;e++){o.push(k[e])}r.push(o.join(" "));n=f-1}}o=new Array();for(var e=n;e<k.length;e++){o.push(k[e])}r.push(o.join(" "));break;default:for(var f=1;f<q.length;f++){obj.html(q.substr(n,f-n));if(h!=obj.height()){r.push(q.substr(n,f-n-1));n=f-1}}r.push(q.substr(n,q.length-n));break}obj.parent().css("width",d);var g="";for(var l=0;l<r.length;l++){g+=p+r[l]+m}obj.html(g+'<hr class="jq-linewrap-clear" />');a(".jq-linewrap-line").css({display:"block","float":b.align,clear:"both",margin:b.margin[0]+"px "+b.margin[1]+"px "+b.margin[2]+"px "+b.margin[3]+"px",padding:b.padding[0]+"px "+b.padding[1]+"px "+b.padding[2]+"px "+b.padding[3]+"px",backgroundColor:b.background,width:"auto",whiteSpace:"nowrap"});a(".jq-linewrap-clear").css({width:"100%",height:"0px",border:"none",clear:"both",margin:"0",padding:"0"})})}})(jQuery);